<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Inventory Dashboard with Filters</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=ABeeZee:ital@0;1&family=Ancizar+Sans:ital,wght@0,100..1000;1,100..1000&family=Roboto:ital,wght@0,100..900;1,100..900&display=swap" rel="stylesheet">
<style>
  :root {
    --bg-light: #f5f7fa;
    --bg-dark: #121212;
    --text-light: #333;
    --text-dark: #eee;
    --primary: #007bff;
    --danger: #dc3545;
    --success: #28a745;
    --warning: #ffc107;
    --font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }
  body {
    margin: 0; padding: 0;
    font-family: var(--font-family);
    background: var(--bg-light);
    color: var(--text-light);
    transition: background-color 0.3s, color 0.3s;
  }
  body.dark {
    background: var(--bg-dark);
    color: var(--text-dark);
  }
  h1 {
    text-align: center;
    margin: 1rem 0;
  }
  .container {
    max-width: 1100px;
    margin: auto;
    padding: 1rem;
  }
  /* Filter section */
  .filters {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    margin-bottom: 1rem;
    align-items: center;
  }
  legend{
    font-family: "ABeeZee", sans-serif;
  }

  label{
    font-family: "ABeeZee", sans-serif;
  }
  .filters label {
    font-weight: 600;
  }
  .filters input[type="text"], .filters select {
    padding: 0.4rem 0.6rem;
    font-size: 1rem;
    border: 1px solid #ccc;
    border-radius: 4px;
    transition: border-color 0.2s;
  }
  .filters input[type="text"]:focus, .filters select:focus {
    outline: none;
    border-color: var(--primary);
  }
  /* Table styles */
  table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 1rem;
  }
  thead {
    background: var(--primary);
    color: white;
  }
  body.dark thead {
    background: #0056b3;
  }
  th, td {
    padding: 0.6rem 0.8rem;
    text-align: left;
    border-bottom: 1px solid #ddd;
  }
  body.dark th, body.dark td {
    border-color: #444;
  }

  body.dark tr:hover {
    background: #333;
  }

  /* NEW: Low Stock highlighting */
  tr.low-stock {
    background-color: var(--danger) !important; /* Use !important to override other styles like hover */
    color: white;
  }
  body.dark tr.low-stock {
    background-color: #a02030 !important; /* Slightly darker red for dark mode */
  }


    input[type="text"]{
    border-radius: 5px;
    height: 30px;
    margin-bottom: 5px;
   }


  /* Buttons */
  button {
    cursor: pointer;
    border: none;
    padding: 4px 8px;
    margin: 0 2px;
    border-radius: 4px;
    font-size: 0.9rem;
    transition: background-color 0.2s;
  }
  button.edit {
    background: var(--primary);
    color: white;
  }
  button.delete {
    background: var(--danger);
    color: white;
  }
  button.duplicate {
    background: var(--warning);
    color: #333;
  }
  button.sold-inc, button.sold-dec {
    background: var(--success);
    color: white;
    font-weight: 700;
  }
  button.sold-dec {
    background: #28a745cc;
  }
  button:disabled {
    opacity: 0.5;
    cursor: not-allowed;
  }


  input[type="number"]{
    border-radius: 5px;
    height: 30px;
  }
  /* Dashboard */
  .dashboard {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    margin-bottom: 2rem;
    justify-content: center;
  }
  .dashboard .card {
    background: white;
    flex: 1 1 150px;
    min-width: 140px;
    padding: 1rem;
    border-radius: 8px;
    box-shadow: 0 0 10px #ccc;
    text-align: center;
  }
  body.dark .dashboard .card {
    background: #222;
    box-shadow: 0 0 10px #000;
  }
  .dashboard .card h2 {
    margin: 0 0 0.5rem;
    font-size: 1.3rem;
  }
  .dashboard .card p {
    margin: 0;
    font-weight: 700;
    font-size: 1.4rem;
  }
  /* Charts container */
  .charts {
    display: flex;
    flex-wrap: wrap;
    gap: 2rem;
    justify-content: center;
    margin-bottom: 2rem;
  }
  .chart-card {
    background: white;
    padding: 1rem;
    border-radius: 8px;
    box-shadow: 0 0 10px #ccc;
    width: 320px;
  }
  body.dark .chart-card {
    background: #222;
    box-shadow: 0 0 10px #000;
  }
  /* Dark mode toggle button */
  #modeToggleBtn {
    position: fixed;
    top: 10px;
    right: 10px;
    background: var(--primary);
    border-radius: 50%;
    width: 40px; height: 40px;
    font-size: 20px;
    color: white;
    border: none;
    cursor: pointer;
    transition: background-color 0.3s;
    z-index: 1000;
  }
  #modeToggleBtn:hover {
    background: #0056b3;
  }
  /* New buttons styling */
  .action-buttons {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    margin-bottom: 20px;
  }

  .action-buttons button {
    padding: 8px 15px;
    font-size: 1rem;
    border-radius: 5px;
  }

  #downloadZipBtn {
    background-color: #6c757d; /* Gray */
    color: white;
  }

  #downloadZipBtn:hover {
    background-color: #5a6268;
  }

  #importJsonBtn {
    background-color: #17a2b8; /* Cyan */
    color: white;
  }

  #importJsonBtn:hover {
    background-color: #138496;
  }

  #printPdfBtn {
    background-color: #dc3545; /* Red for print */
    color: white;
  }

  #printPdfBtn:hover {
    background-color: #c82333;
  }

  /* Responsive */
  @media (max-width: 768px) {
    .filters {
      flex-direction: column;
      align-items: stretch;
    }
    .dashboard {
      flex-direction: column;
      align-items: stretch;
    }
    .charts {
      flex-direction: column;
      align-items: center;
    }
    .chart-card {
      width: 100%;
      max-width: 400px;
    }
    .action-buttons {
      flex-direction: column;
      align-items: stretch;
    }
  }

  .container h1{
    font-family: "ABeeZee", sans-serif;
   font-weight: bold;
   font-size: 2.5rem;
   
  }
</style>
</head>
<body>
<button id="modeToggleBtn" aria-label="Toggle Dark Mode">🌙</button>
<div class="container">
  <h1>Inventory Management Dashboard</h1>

  <div class="filters" aria-label="Filter inventory items">
    <label for="filterName">Name:</label>
    <input type="text" id="filterName" placeholder="Search by name" />

    <label for="filterBrand">Brand:</label>
    <input type="text" id="filterBrand" placeholder="Search by brand" />

    <label for="filterStatus">Status:</label>
    <select id="filterStatus" aria-label="Filter by stock status">
      <option value="all">Show All</option>
      <option value="inStock">In Stock</option>
      <option value="soldOut">Sold Out</option>
      <option value="lowStock">Low Stock (<= 5)</option> <option value="highSold">High Sold</option>
      <option value="lowSold">Low Sold</option>
    </select>
  </div>

  <div class="action-buttons">
    <button id="downloadZipBtn">Download Inventory (ZIP)</button>
    <input type="file" id="importJsonFile" accept=".json" style="display: none;">
    <button id="importJsonBtn">Import Inventory (JSON)</button>
    <button id="printPdfBtn">Print PDF</button>
  </div>

  <form id="addItemForm" aria-label="Add new inventory item">
    <fieldset>
      <legend>Add New Item</legend>
      <label>
        Item Name: <input type="text" id="itemName" required />
      </label>
      <label>
        Brand: <input type="text" id="brand" required />
      </label>
      <label>
        Total Quantity: <input type="number" id="totalQuantity" min="1" required />
      </label>
      <label>
        Sold: <input type="number" id="sold" min="0" value="0" required />
      </label>
      <label>
        Price (per unit Rs): <input type="number" id="price" min="0" step="0.01" required />
      </label>
      <button type="submit">Add Item</button>
    </fieldset>
  </form>

  <table aria-label="Inventory items table" id="itemTable" role="grid">
    <thead>
      <tr>
        <th>Item Name</th>
        <th>Brand</th>
        <th>Total Quantity</th>
        <th>Sold</th>
        <th>In Stock</th>
        <th>Date Added</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody id="itemTableBody"></tbody>
  </table>

  <section class="dashboard" aria-label="Inventory summary">
    <div class="card"><h2>Total Items</h2><p id="totalItemsCount">0</p></div>
    <div class="card"><h2>Total Quantity</h2><p id="totalQuantityCount">0</p></div>
    <div class="card"><h2>Total Sold</h2><p id="totalSoldCount">0</p></div>
    <div class="card"><h2>In Stock</h2><p id="totalInStockCount">0</p></div>
    <div class="card"><h2>Total Value</h2><p id="totalValueCount">Rs 0.00</p></div>
  </section>

  <section class="charts" aria-label="Sales charts">
    <div class="chart-card">
      <h3>Monthly Sold Items</h3>
      <canvas id="monthlySoldBarChart" aria-label="Bar chart showing items sold per month" role="img"></canvas>
    </div>
    <div class="chart-card">
      <h3>Sold Items Distribution</h3>
      <canvas id="soldItemsPieChart" aria-label="Pie chart showing distribution of sold items" role="img"></canvas>
    </div>
  </section>
</div>

<footer style="background-color: #003366; color: white; text-align: center; padding: 20px 0; font-family: 'Poppins', sans-serif;">
  <p style="margin: 0; font-size: 14px;">&copy; Developed by Shane Computers.</p>
</footer>


<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<script>
  // Elements references
  const addItemForm = document.getElementById('addItemForm');
  const itemTableBody = document.getElementById('itemTableBody');
  const totalItemsCount = document.getElementById('totalItemsCount');
  const totalQuantityCount = document.getElementById('totalQuantityCount');
  const totalSoldCount = document.getElementById('totalSoldCount');
  const totalInStockCount = document.getElementById('totalInStockCount');
  const totalValueCount = document.getElementById('totalValueCount');
  const monthlySoldBarChartCtx = document.getElementById('monthlySoldBarChart').getContext('2d');
  const soldItemsPieChartCtx = document.getElementById('soldItemsPieChart').getContext('2d');
  const modeToggleBtn = document.getElementById('modeToggleBtn');

  // Filter inputs
  const filterNameInput = document.getElementById('filterName');
  const filterBrandInput = document.getElementById('filterBrand');
  const filterStatusSelect = document.getElementById('filterStatus');

  // New button references
  const downloadZipBtn = document.getElementById('downloadZipBtn');
  const importJsonFile = document.getElementById('importJsonFile');
  const importJsonBtn = document.getElementById('importJsonBtn');
  const printPdfBtn = document.getElementById('printPdfBtn');


  // Data storage
  let items = JSON.parse(localStorage.getItem('inventoryItems')) || [];

  // Password for editing/deleting
  const password = '789632';

  // Chart instances
  let monthlySoldBarChart = null;
  let soldItemsPieChart = null;

  // Save items to localStorage
  function saveItems() {
    localStorage.setItem('inventoryItems', JSON.stringify(items));
  }

  // Filter & refresh UI function
  function refreshUI() {
    // Clear table
    itemTableBody.innerHTML = '';

    // Get filters
    const nameFilter = filterNameInput.value.trim().toLowerCase();
    const brandFilter = filterBrandInput.value.trim().toLowerCase();
    const statusFilter = filterStatusSelect.value;

    // First, filter by name and brand
    let displayItems = items.filter(item => {
      const matchesName = item.name.toLowerCase().includes(nameFilter);
      const matchesBrand = item.brand.toLowerCase().includes(brandFilter);
      return matchesName && matchesBrand;
    });

    // Then, apply status filtering (inStock/soldOut/lowStock) or sorting (highSold/lowSold)
    if (statusFilter === 'inStock') {
      displayItems = displayItems.filter(item => (item.totalQuantity - item.sold) > 0);
    } else if (statusFilter === 'soldOut') {
      displayItems = displayItems.filter(item => (item.totalQuantity - item.sold) <= 0);
    } else if (statusFilter === 'lowStock') { // NEW: Low Stock filter logic
      displayItems = displayItems.filter(item => (item.totalQuantity - item.sold) <= 5);
    } else if (statusFilter === 'highSold') {
      displayItems.sort((a, b) => b.sold - a.sold); // Sort by sold quantity (descending)
    } else if (statusFilter === 'lowSold') {
      displayItems.sort((a, b) => a.sold - b.sold); // Sort by sold quantity (ascending)
    }

    displayItems.forEach(item => {
      const tr = document.createElement('tr');

      // In stock count
      const inStockCount = item.totalQuantity - item.sold;

      // NEW: Add 'low-stock' class if item is low in stock
      if (inStockCount <= 5) {
        tr.classList.add('low-stock');
      }

      tr.innerHTML = `
        <td>${item.name}</td>
        <td>${item.brand}</td>
        <td>${item.totalQuantity}</td>
        <td>
          <button class="sold-dec" aria-label="Decrease sold count for ${item.name}" ${item.sold <= 0 ? 'disabled' : ''}>-</button>
          ${item.sold}
          <button class="sold-inc" aria-label="Increase sold count for ${item.name}" ${inStockCount <= 0 ? 'disabled' : ''}>+</button>
        </td>
        <td>${inStockCount}</td>
        <td>${new Date(item.dateAdded).toLocaleDateString()}</td>
        <td>
          <button class="edit" aria-label="Edit ${item.name}">Edit</button>
          <button class="delete" aria-label="Delete ${item.name}">Delete</button>
          <button class="duplicate" aria-label="Duplicate ${item.name}">Duplicate</button>
        </td>
      `;

      // Sold decrement
      tr.querySelector('.sold-dec').onclick = () => {
        if (item.sold > 0) {
          item.sold--;
          saveItems();
          refreshUI();
        }
      };
      // Sold increment
      tr.querySelector('.sold-inc').onclick = () => {
        if (inStockCount > 0) {
          item.sold++;
          saveItems();
          refreshUI();
        }
      };

      // Edit button with password prompt
      tr.querySelector('.edit').onclick = () => {
        const userPass = prompt('Enter password to edit this item:');
        if (userPass === password) {
          const newName = prompt('Enter new item name:', item.name);
          if (!newName) return alert('Name cannot be empty.');
          const newBrand = prompt('Enter new brand:', item.brand);
          if (!newBrand) return alert('Brand cannot be empty.');
          const newTotalQty = parseInt(prompt('Enter new total quantity:', item.totalQuantity), 10);
          if (isNaN(newTotalQty) || newTotalQty < 0) return alert('Invalid total quantity.');
          const newSold = parseInt(prompt('Enter new sold quantity:', item.sold), 10);
          if (isNaN(newSold) || newSold < 0 || newSold > newTotalQty) return alert('Invalid sold quantity.');
          const newPrice = parseFloat(prompt('Enter new price per unit:', item.price));
          if (isNaN(newPrice) || newPrice < 0) return alert('Invalid price.');

          item.name = newName;
          item.brand = newBrand;
          item.totalQuantity = newTotalQty;
          item.sold = newSold;
          item.price = newPrice;

          saveItems();
          refreshUI();
        } else {
          alert('Wrong password!');
        }
      };

      // Delete button with password prompt
      tr.querySelector('.delete').onclick = () => {
        const userPass = prompt('Enter password to delete this item:');
        if (userPass === password) {
          items = items.filter(i => i !== item);
          saveItems();
          refreshUI();
        } else {
          alert('Wrong password!');
        }
      };

      // Duplicate item button
      tr.querySelector('.duplicate').onclick = () => {
        let newName = item.name;
        let counter = 0;
        while (items.find(i => i.name.toLowerCase() === newName.toLowerCase())) {
          counter++;
          newName = item.name + ` - Copy (${counter})`;
        }
        items.push({
          ...item,
          name: newName,
          dateAdded: new Date().toISOString()
        });
        saveItems();
        refreshUI();
      };

      itemTableBody.appendChild(tr);
    });

    updateDashboard();
    updateCharts();
  }

  // Dashboard stats
  function updateDashboard() {
    const totalItems = items.length;
    const totalQuantity = items.reduce((acc, i) => acc + i.totalQuantity, 0);
    const totalSold = items.reduce((acc, i) => acc + i.sold, 0);
    const totalInStock = totalQuantity - totalSold;
    const totalValue = items.reduce((acc, i) => acc + i.price * (i.totalQuantity - i.sold), 0);

    totalItemsCount.textContent = totalItems;
    totalQuantityCount.textContent = totalQuantity;
    totalSoldCount.textContent = totalSold;
    totalInStockCount.textContent = totalInStock;
    totalValueCount.textContent = `Rs ${totalValue.toFixed(2)}`;
  }

  // Charts update
  function updateCharts() {
    // Monthly Sold Bar Chart
    const monthlyData = {};

    items.forEach(item => {
      if (item.sold > 0) {
        const d = new Date(item.dateAdded);
        if (isNaN(d)) return;
        const key = `${d.getFullYear()}-${('0' + (d.getMonth() + 1)).slice(-2)}`;
        if (!monthlyData[key]) monthlyData[key] = 0;
        monthlyData[key] += item.sold;
      }
    });

    const months = Object.keys(monthlyData).sort();

    const monthLabels = months.map(m => {
      const [year, month] = m.split('-');
      const date = new Date(year, month - 1);
      return date.toLocaleString('default', { month: 'short', year: 'numeric' });
    });

    const soldCounts = months.map(m => monthlyData[m]);

    if (monthlySoldBarChart) monthlySoldBarChart.destroy();

    monthlySoldBarChart = new Chart(monthlySoldBarChartCtx, {
      type: 'bar',
      data: {
        labels: monthLabels,
        datasets: [{
          label: 'Items Sold',
          data: soldCounts,
          backgroundColor: 'rgba(0, 123, 255, 0.7)',
          borderColor: 'rgba(0, 123, 255, 1)',
          borderWidth: 1,
          borderRadius: 4,
        }]
      },
      options: {
        responsive: true,
        scales: {
          y: { beginAtZero: true, stepSize: 1 },
        },
        plugins: {
          legend: { display: false },
          tooltip: { enabled: true }
        }
      }
    });

    // Pie Chart: Sold items distribution
    const soldItemsData = {};
    items.forEach(item => {
      if (item.sold > 0) {
        soldItemsData[item.name] = (soldItemsData[item.name] || 0) + item.sold;
      }
    });

    const pieLabels = Object.keys(soldItemsData);
    const pieValues = Object.values(soldItemsData);
    const pieColors = pieLabels.map(() => `hsl(${Math.random() * 360}, 70%, 60%)`);

    if (soldItemsPieChart) soldItemsPieChart.destroy();

    soldItemsPieChart = new Chart(soldItemsPieChartCtx, {
      type: 'pie',
      data: {
        labels: pieLabels,
        datasets: [{
          data: pieValues,
          backgroundColor: pieColors,
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { position: 'bottom' },
          tooltip: { enabled: true }
        }
      }
    });
  }

  // Add item form submit handler
  addItemForm.onsubmit = (e) => {
    e.preventDefault();

    const name = document.getElementById('itemName').value.trim();
    const brand = document.getElementById('brand').value.trim();
    const totalQuantity = parseInt(document.getElementById('totalQuantity').value, 10);
    const sold = parseInt(document.getElementById('sold').value, 10);
    const price = parseFloat(document.getElementById('price').value);

    if (!name || !brand || isNaN(totalQuantity) || isNaN(sold) || isNaN(price)) {
      alert('Please fill all fields correctly.');
      return;
    }
    if (sold > totalQuantity) {
      alert('Sold quantity cannot be greater than total quantity.');
      return;
    }

    // Check if item name already exists (case-insensitive)
    if (items.some(i => i.name.toLowerCase() === name.toLowerCase())) {
      alert('An item with this name already exists. Please use a different name or duplicate it later.');
      return;
    }

    const newItem = {
      name,
      brand,
      totalQuantity,
      sold,
      price,
      dateAdded: new Date().toISOString()
    };

    items.push(newItem);
    saveItems();
    refreshUI();

    addItemForm.reset();
  };

  // Filters event listeners
  filterNameInput.oninput = refreshUI;
  filterBrandInput.oninput = refreshUI;
  filterStatusSelect.onchange = refreshUI;

  // Dark mode toggle
  function loadDarkModeSetting() {
    if(localStorage.getItem('darkMode') === 'true') {
      document.body.classList.add('dark');
      modeToggleBtn.textContent = '☀️';
    } else {
      document.body.classList.remove('dark');
      modeToggleBtn.textContent = '🌙';
    }
  }
  modeToggleBtn.onclick = () => {
    document.body.classList.toggle('dark');
    const darkModeOn = document.body.classList.contains('dark');
    localStorage.setItem('darkMode', darkModeOn);
    modeToggleBtn.textContent = darkModeOn ? '☀️' : '🌙';
  };

  // --- NEW FUNCTIONALITY ---

  // Download Inventory (ZIP)
  downloadZipBtn.onclick = async () => {
    const zip = new JSZip();
    const inventoryJson = JSON.stringify(items, null, 2); // Pretty print JSON

    zip.file("inventory_data.json", inventoryJson);

    // Generate the ZIP file
    const content = await zip.generateAsync({ type: "blob" });

    // Create a download link
    const link = document.createElement('a');
    link.href = URL.createObjectURL(content);
    link.download = `inventory_backup_${new Date().toISOString().slice(0,10)}.zip`;
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
    URL.revokeObjectURL(link.href);
    alert('Inventory data downloaded as ZIP!');
  };

  // Import Inventory (JSON)
  importJsonBtn.onclick = () => {
    importJsonFile.click(); // Trigger the hidden file input click
  };

  importJsonFile.onchange = (event) => {
    const file = event.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = (e) => {
        try {
          const importedData = JSON.parse(e.target.result);
          if (Array.isArray(importedData)) {
            // Basic validation for imported data structure
            const isValid = importedData.every(item =>
              typeof item.name === 'string' &&
              typeof item.brand === 'string' &&
              typeof item.totalQuantity === 'number' &&
              typeof item.sold === 'number' &&
              typeof item.price === 'number' &&
              typeof item.dateAdded === 'string'
            );

            if (isValid) {
              const confirmImport = confirm("Importing will overwrite your current inventory. Are you sure?");
              if (confirmImport) {
                items = importedData;
                saveItems();
                refreshUI();
                alert('Inventory data imported successfully!');
              }
            } else {
              alert('Invalid JSON structure. Please ensure the imported file contains an array of inventory items with correct properties.');
            }
          } else {
            alert('Invalid JSON file. Expected an array of inventory items.');
          }
        } catch (error) {
          alert('Error parsing JSON file. Please ensure it is a valid JSON.');
          console.error('Error importing JSON:', error);
        }
      };
      reader.readAsText(file);
    }
  };

  // Print PDF
  printPdfBtn.onclick = () => {
    const element = document.querySelector('.container'); // Or target a more specific element if needed

    // Temporarily hide elements not needed in PDF
    const elementsToHide = [addItemForm, document.querySelector('.action-buttons'), document.getElementById('modeToggleBtn')];
    elementsToHide.forEach(el => el.style.display = 'none');

    // Add a title for the PDF
    const originalTitle = document.querySelector('h1').outerHTML;
    document.querySelector('h1').outerHTML = `<h1>Inventory Report - ${new Date().toLocaleDateString()}</h1>`;

    html2pdf().from(element).set({
      margin: 1,
      filename: `inventory_report_${new Date().toISOString().slice(0,10)}.pdf`,
      html2canvas: { scale: 2, logging: true, dpi: 192, letterRendering: true },
      jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
    }).save().then(() => {
      // Restore original display
      elementsToHide.forEach(el => el.style.display = '');
      document.querySelector('h1').outerHTML = originalTitle; // Restore original h1
    });
  };

  // Initial load
  loadDarkModeSetting();
  refreshUI();
</script>
</body>
</html>
